# VR-модуль
## Описание
Модуль виртальной расходометрии содержит 4 микросервиса:

* микросервис расчета адаптациионных коэффициентов штуцера (adapt);

* микросервис валидации данных (validate);

* микросервис расчета дебитов газа, газаконденсата и воды на основе физико-математической модели (fmm);

* микросервис расчета дебитов газа, газаконденсата и воды на основе ML-модели (calculation_service_ml).

## Запуск

### Оркестрированный запуск

Оркестрированный запуск всех микросервисов рекомендуется выполнять с помощью команд:

* клонировать репозиторий:

```shell
git clone https://github.com/OGPT-tech/VR_MOCK/tree/fastapi_mocks
```

* выполнить запуск микросервисов из директории infra командой:
     ```shell
     docker-compose up -d --build
    ```
### Запуск отдельного микросервиса в контейнере
Для запуска отдельного микросервиса необходимо скопировать Dockerfile из infra в директорию одно из необходимых сервисов и выполнить команду из директории сервиса (заменив image_name и SERVICE_PORT на необходимые):
```shell
docker run -t <image_name> --build-arg PROJECT_PORT=<SERVICE_PORT> PROJECT_HOST=<SERVICE_HOST> RELOAD=<BOOL>.
```

### Локальный запуск микросервиса
Для локального запуска микросервиса необходимо:
* создать виртуальное окружение, выполнив в корневой директории команду:
```shell
python -m venv venv
```
* активировать виртуальное окружение

    * Linux
    ```shell
    source venv/bin/activate
    ```
    * Windows
    ```shell
    .\venv\Scripts\activate
    ```
* установить зависимости:
```shell
python -m pip install -r requirements.txt
```
* выполнить команду:
```shell
python main.py
```

## Описание API

Документация находится по адресу
```
  http://<PROJECT_HOST>:<PROJECT_PORT>/api/openapi/
```
